<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>BOJA Checker</title>
<style>
body { font-family: sans-serif; background: #f8f9fa; margin: 2rem; color: #222; }
h1 { color: #005500; margin-bottom: 1.5rem; }
#controls { display: flex; flex-direction: column; gap: 1rem; max-width: 700px; }
input[type="text"] { padding: 10px; font-size: 1rem; border: 1px solid #ccc; border-radius: 6px; width: 100%; }
button { background: #28a745; color: white; border: none; padding: 10px 20px; border-radius: 8px; cursor: pointer; font-size: 1rem; width: fit-content; }
button:hover { background: #218838; }
#info { margin-top: 2rem; font-weight: bold; }
#resultado { margin-top: 2rem; white-space: pre-wrap; line-height: 1.5; }
mark { background: #9f9; font-weight: bold; }
</style>
</head>
<body>
<h1>üìú Comprobador BOJA</h1>

<div id="controls">
  <label for="textoBuscado"><b>Texto a buscar:</b></label>
  <input id="textoBuscado" type="text" placeholder="Escribe aqu√≠ la frase que quieres buscar">
  <button id="buscar">Buscar frase en el sumario</button>
</div>

<div id="info"></div>
<div id="resultado"></div>

<script>
document.getElementById("buscar").addEventListener("click", async () => {
  const frase = document.getElementById("textoBuscado").value.trim();
  const info = document.getElementById("info");
  const resultado = document.getElementById("resultado");
  info.textContent = "";
  resultado.textContent = "";

  if (!frase) { info.textContent = "‚ö†Ô∏è Escribe un texto antes de buscar."; return; }

  info.textContent = "üîç Cargando sumario...";
  try {
    const resp = await fetch("sumario.txt");
    if (!resp.ok) throw new Error("No se pudo leer sumario.txt");
    let texto = await resp.text();

    const textoLower = texto.toLowerCase();
    const fraseLower = frase.toLowerCase();

    // Buscar primera coincidencia exacta
    let similitud = 0;
    let pos = textoLower.indexOf(fraseLower);
    if (pos >= 0) {
      similitud = 100;
      texto = texto.slice(0,pos) + "<mark>" + texto.slice(pos,pos+frase.length) + "</mark>" + texto.slice(pos+frase.length);
    } else {
      // aproximaci√≥n simple: % de palabras coincidentes
      const palabras = fraseLower.split(/\s+/).filter(Boolean);
      const coincidencias = palabras.filter(p => textoLower.includes(p));
      similitud = palabras.length ? Math.round(coincidencias.length / palabras.length * 100) : 0;
    }

    resultado.innerHTML = `<p><b>Similitud:</b> ${similitud}%</p><hr>${texto}`;
    info.textContent = "‚úÖ Sumario cargado y analizado.";
  } catch(err) {
    info.textContent = "‚ùå Error: " + err;
  }
});
</script>
</body>
</html>
